---
title: <font color="#66C2A5">Graphs</font>
csl: apa-custom-no-issue.csl
output: 
  html_document:
    code_folding: "hide"
editor_options: 
  chunk_output_type: console
---

## {.tabset}

### Library
```{r Library}
library(formr)
library(effects)
library(effectsize)
library(lme4)
library(sjstats)
library(lmerTest)
library(ggplot2)
library(tidyr)
library(ggpubr)
library(RColorBrewer)
library(coefplot)
library(dplyr)
library(tidyverse)
library (gridExtra)
library(cowplot)
library(minqa)


apatheme = theme_bw() +
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    axis.line = element_line(),
    legend.title = element_blank(),
    plot.title = element_text(hjust = 0.5)
  )
```

### Data
Load selected data based on 03_codebook
```{r}
data_included_documented = read.csv(file = "data_included_documented.csv")[, -1]
data_included_documented = data_included_documented %>%
  filter(!is.na(political_orientation)) #check
```

### Figure 4 {.tabset .active}
Effect size estimates of linear effects of political orientation on preferred relationship options for main analyses and one robustness analysis.

#### Main Analyses
```{r}
model_interest_single <-
  as.data.frame(standardize_parameters(
    lmer(
      interest_single ~ political_orientation + (1 + political_orientation |
                                                   country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_interest_sexrel <-
  as.data.frame(standardize_parameters(
    lmer(
      interest_sexrel ~ political_orientation + (1 + political_orientation |
                                                   country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_interest_nonmonrel <-
  as.data.frame(standardize_parameters(
    lmer(
      interest_nonmonrel ~ political_orientation + (1 + political_orientation |
                                                      country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_interest_monrel <-
  as.data.frame(standardize_parameters(
    lmer(
      interest_monrel ~ political_orientation + (1 + political_orientation |
                                                   country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))
```

#### Robustness Analyses
Additionally including age as a predictor
```{r}
model_interest_single_robustcheck <-
  as.data.frame(standardize_parameters(
    lmer(
      interest_single ~ political_orientation + age + (1 + political_orientation |
                                                         country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_interest_sexrel_robustcheck <-
  as.data.frame(standardize_parameters(
    lmer(
      interest_sexrel ~ political_orientation + age + (1 + political_orientation |
                                                         country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_interest_nonmonrel_robustcheck <-
  as.data.frame(standardize_parameters(
    lmer(
      interest_nonmonrel ~ political_orientation + age + (1 + political_orientation |
                                                            country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_interest_monrel_robustcheck  <-
  as.data.frame(standardize_parameters(
    lmer(
      interest_monrel ~ political_orientation + age + (1 + political_orientation |
                                                         country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))
```


#### Combine {.active}
```{r}
all_models_interest <- rbind(
  model_interest_single,
  model_interest_sexrel,
  model_interest_nonmonrel,
  model_interest_monrel,
  model_interest_single_robustcheck,
  model_interest_sexrel_robustcheck,
  model_interest_nonmonrel_robustcheck,
  model_interest_monrel_robustcheck
) %>%
  filter(Parameter == "political_orientation")

all_models_interest$hypothesis = factor(
  rep(
    c(
      "S1) Interest in Single Life",
      "S2) Interest in Sexual,\nNon-Romantic Relationships",
      "S3) Interest in \nNon-Monogamous Relationships",
      "S4) Interest in \nMonogamous Relationships"
    ),
    2
  ),
  levels = c(
    "S4) Interest in \nMonogamous Relationships",
    "S3) Interest in \nNon-Monogamous Relationships",
    "S2) Interest in Sexual,\nNon-Romantic Relationships",
    "S1) Interest in Single Life"
  )
)

all_models_interest$type = factor(c(rep("Main Analyses", 4), rep("Robustness Analyses", 4)),
                                  levels = c("Robustness Analyses", "Main Analyses"))


multiplot = ggplot(all_models_interest, aes(hypothesis, Std_Coefficient)) +
  geom_pointrange(
    data = all_models_interest,
    mapping = aes(
      x = hypothesis,
      y = Std_Coefficient,
      ymin = CI_low,
      ymax = CI_high,
      group = type,
      color = type
    ),
    position = position_dodge(width = 0.3)
  ) +
  geom_hline(yintercept = 0, linewidth = 1.5)  +
  geom_hline(yintercept = -.05,
             linetype = "dotted",
             linewidth = 1.5) +
  geom_hline(yintercept = .05,
             linetype = "dotted",
             linewidth = 1.5) +
  coord_flip() +
  apatheme +
  scale_colour_manual(values = c("#86BDDB", "#084594"))  +
  labs(y = "Linear Effect of Political Orientation", x = "Outcome") +
  theme(
    text = element_text(size = 15),
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    legend.text = element_text(size = 10),
    plot.title = element_text(hjust = 0),
    legend.background = element_rect(
      fill = "grey",
      linewidth = 0.5,
      linetype = "solid"
    )
  ) +
  #theme(legend.position=c(0.8, 0.8)) +
  guides(col = guide_legend(reverse = TRUE))
multiplot
```

#### Save image
```{r}
jpeg("Figure4.1.jpeg",
     width = 3150,
     height = 2100,
     res = 300)
multiplot
dev.off()
```

### Figure 5 {.tabset}
Effect size estimates of quadratic effect of political orientation on preferred political similarity for main analysis and one robustness analysis.  

#### Analyses {.active}
```{r}
data_included_nomiss_politicalsim_smaller = data_included_documented %>%
  filter(!is.na(pref_politicalsim)) %>%
  filter(political_orientation <= 3)


model_pref_politicalsim_1 = lmer(
  pref_politicalsim ~ political_orientation +
    (1 + political_orientation |
       country),
  data = data_included_nomiss_politicalsim_smaller,
  control = lmerControl(optimizer = "bobyqa")
)
pred_pref_politicalsim_1 = predict(model_pref_politicalsim_1)

data_included_nomiss_politicalsim_smaller$pred_pref_politicalsim_1 =
  pred_pref_politicalsim_1


data_included_nomiss_politicalsim_larger = data_included_documented %>%
  filter(!is.na(pref_politicalsim)) %>%
  filter(political_orientation >= 3)


model_pref_politicalsim_1 = lmer(
  pref_politicalsim ~ political_orientation +
    (1 + political_orientation |
       country),
  data = data_included_nomiss_politicalsim_larger,
  control = lmerControl(optimizer = "bobyqa")
)
pred_pref_politicalsim_1 = predict(model_pref_politicalsim_1)

data_included_nomiss_politicalsim_larger$pred_pref_politicalsim_1 =
  pred_pref_politicalsim_1

data_included_nomiss_politicalsim = rbind(
  data_included_nomiss_politicalsim_smaller,
  data_included_nomiss_politicalsim_larger
)

#Plotting empirical values
graph_emp =
  ggplot(data = data_included_nomiss_politicalsim,
         aes(x = political_orientation, y = pred_pref_politicalsim_1)) +
  geom_jitter(aes(y = pref_politicalsim),
              alpha = 0.5,
              color = "grey44") +
  geom_smooth(
    method = 'lm',
    formula = y ~ x,
    fill = "#B22222",
    color = "#B22222",
    level = 0.997,
    data = data_included_nomiss_politicalsim %>%
      filter(political_orientation <= 3)
  ) +
  geom_smooth(
    method = 'lm',
    formula = y ~ x,
    fill = "#084594",
    color = "#084594",
    level = 0.997,
    data = data_included_nomiss_politicalsim %>%
      filter(political_orientation >= 3)
  ) +
  geom_vline(xintercept = 3,
             linetype = "dashed",
             linewidth = 1) +
  apatheme +
  labs(y = "Preferred Political Similarity\n(Empirical Values)", x = "Political Orientation") +
  scale_x_continuous(breaks = c(0, 1, 2, 3, 4, 5, 6)) +
  scale_y_continuous(breaks = c(0, 1, 2, 3, 4, 5, 6)) +
  theme(
    text = element_text(size = 20),
    axis.text.x = element_text(size = 15),
    axis.text.y = element_text(size = 15)
  )

graph_emp
```


#### Save image
```{r}
jpeg("Figure5.jpeg",
     width = 3000,
     height = 3000,
     res = 300)
graph_emp
dev.off()
```

### Figure 6 {.tabset}
Effect size estimates of linear effects of political orientation on preferred political, ethnical and religious similarity for main analyses and one robustness analysis. Graph further includes both linear effect size estimates according to the Two Lines Approach. 

#### Main Analyses
```{r}
# H1a(1) Linear Effect on Political Similarity
model_pref_politicalsim_lin <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_politicalsim ~
        political_orientation +
        (1 + political_orientation |
           country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

#H1a(2) Quadratic Effect on Political Similarity
model_pref_politicalsim_1 <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_politicalsim ~ political_orientation +                       (1 + political_orientation |
                                                                           country),
      data = data_included_documented
      %>%                     dplyr::filter(political_orientation <= 3),
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_pref_politicalsim_2 <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_politicalsim ~ political_orientation +                       (1 + political_orientation |
                                                                           country),
      data = data_included_documented
      %>%                     dplyr::filter(political_orientation >= 3),
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_pref_ethnicalsim <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_ethnicalsim ~ political_orientation + (1 + political_orientation |
                                                    country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_pref_religioussim <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_religioussim ~ political_orientation + (1 + political_orientation |
                                                     country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))
```

#### Robustness Analyses
Additionally including age as a predictor
```{r}
# H1a(1) Linear Effect on Political Similarity
model_pref_politicalsim_lin_robustcheck <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_politicalsim ~ political_orientation  + age +
        (1 + political_orientation | country),
      data =
        data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

#H1a(2) Quadratic Effect on Political Similarity

model_pref_politicalsim_1_robustcheck <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_politicalsim ~ political_orientation + age +
        (1 + political_orientation |
           country),
      data = data_included_documented %>%
        dplyr::filter(political_orientation <= 3),
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_pref_politicalsim_2_robustcheck <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_politicalsim ~ political_orientation + age +
        (1 + political_orientation |
           country),
      data = data_included_documented %>%
        dplyr::filter(political_orientation >= 3),
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_pref_ethnicalsim_robustcheck <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_ethnicalsim ~ political_orientation + age + (1 + political_orientation |
                                                          country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_pref_religioussim_robustcheck <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_religioussim ~ political_orientation + age + (1 + political_orientation |
                                                           country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))
```


#### Combine {.active}
```{r}
all_models_similarity <- rbind(
  model_pref_politicalsim_lin,
  model_pref_politicalsim_1,
  model_pref_politicalsim_2,
  model_pref_ethnicalsim,
  model_pref_religioussim,
  model_pref_politicalsim_lin_robustcheck,
  model_pref_politicalsim_1_robustcheck,
  model_pref_politicalsim_2_robustcheck,
  model_pref_ethnicalsim_robustcheck,
  model_pref_religioussim_robustcheck
) %>%
  filter(Parameter == "political_orientation")



all_models_similarity = rbind(
  all_models_similarity[1, ],
  c("political_orientation", NA, 0.997, NA, NA),
  all_models_similarity[2:3, ],
  c("political_orientation", NA, 0.997, NA, NA),
  all_models_similarity[4, ],
  c("political_orientation", NA, 0.997, NA, NA),
  all_models_similarity[5:6, ],
  c("political_orientation", NA, 0.997, NA, NA),
  all_models_similarity[7:8, ],
  c("political_orientation", NA, 0.997, NA, NA),
  all_models_similarity[9, ],
  c("political_orientation", NA, 0.997, NA, NA),
  all_models_similarity[10, ]
)


all_models_similarity$hypothesis = factor(
  c(
    "H1a(1) Preferred \nPolitical Similarity \n(Linear Effect)",
    "",
    "H1a(2) Preferred \nPolitical Similarity \n(Quadratic Effect) \nRWPO <= 3",
    "H1a(2) Preferred \nPolitical Similarity \n(Quadratic Effect) \nRWPO >= 3",
    "",
    "H1b) Preferred \nEthnic Similarity",
    "   ",
    "H1c) Preferred \nReligious Similarity",
    "H1a(1) Preferred \nPolitical Similarity \n(Linear Effect)",
    " ",
    "H1a(2) Preferred \nPolitical Similarity \n(Quadratic Effect) \nRWPO <= 3",
    "H1a(2) Preferred \nPolitical Similarity \n(Quadratic Effect) \nRWPO >= 3",
    " ",
    "H1b) Preferred \nEthnic Similarity",
    "   ",
    "H1c) Preferred \nReligious Similarity"
  ),
  levels = c(
    "H1c) Preferred \nReligious Similarity",
    "   ",
    "H1b) Preferred \nEthnic Similarity",
    " ",
    "H1a(2) Preferred \nPolitical Similarity \n(Quadratic Effect) \nRWPO >= 3",
    "H1a(2) Preferred \nPolitical Similarity \n(Quadratic Effect) \nRWPO <= 3",
    "",
    "H1a(1) Preferred \nPolitical Similarity \n(Linear Effect)"
  )
)

all_models_similarity$type = factor(c(rep("Main Analyses", 8), rep("Robustness Analyses", 8)),
                                    levels = c("Robustness Analyses", "Main Analyses"))

all_models_similarity$Std_Coefficient = as.numeric(all_models_similarity$Std_Coefficient)

all_models_similarity$CI_low = as.numeric(all_models_similarity$CI_low)

all_models_similarity$CI_high = as.numeric(all_models_similarity$CI_high)

multiplot = ggplot(all_models_similarity, aes(hypothesis, Std_Coefficient)) +
  geom_pointrange(
    data = all_models_similarity,
    mapping = aes(
      x = hypothesis,
      y = Std_Coefficient,
      ymin = CI_low,
      ymax = CI_high,
      group = type,
      color = type
    ),
    position = position_dodge(width = c(0.3))
  ) +
  geom_hline(yintercept = 0, linewidth = 1.5)  +
  geom_hline(yintercept = -.05,
             linetype = "dotted",
             linewidth = 1.5) +
  geom_hline(yintercept = .05,
             linetype = "dotted",
             linewidth = 1.5) +
  coord_flip() +
  apatheme +
  scale_colour_manual(values = c("#86BDDB", "#084594"))  +
  labs(y = "Linear Effect of Political Orientation", x = "Outcome") +
  theme(
    text = element_text(size = 15),
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    legend.text = element_text(size = 10),
    plot.title = element_text(hjust = 0),
    legend.background = element_rect(
      fill = "grey",
      linewidth = 0.5,
      linetype = "solid"
    )
  ) +
  guides(col = guide_legend(reverse = TRUE)) +
  theme(axis.ticks.y = element_blank())
multiplot
```


#### Save image
```{r}
jpeg("Figure6.1.jpeg",
     width = 3150,
     height = 2100,
     res = 300)
multiplot
dev.off()
```

### Figure 7 {.tabset}
Effect size estimates of linear effects of political orientation on ideal partner preferences for main analyses and one robustness analysis.

#### Main Analyses
```{r}
model_pref_level_financially_secure_successful_ambitious <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_level_financially_secure_successful_ambitious ~ political_orientation + (1 +
                                                                                      political_orientation | country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_pref_level_confident_assertive <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_level_confident_assertive ~ political_orientation + (1 + political_orientation |
                                                                  country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_pref_level_intelligence_educated <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_level_intelligence_educated ~ political_orientation + (1 + political_orientation |
                                                                    country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_pref_level_kind_supportive <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_level_kind_supportive ~ political_orientation + (1 + political_orientation |
                                                              country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_pref_level_attractiveness <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_level_attractiveness ~ political_orientation + (1 + political_orientation |
                                                             country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))
```

#### Robustness Analyses
Additionally including age as a predictor
```{r}
model_pref_level_financially_secure_successful_ambitious_robustcheck <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_level_financially_secure_successful_ambitious ~ political_orientation + age + (1 +
                                                                                            political_orientation | country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_pref_level_confident_assertive_robustcheck  <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_level_confident_assertive ~ political_orientation + age + (1 + political_orientation |
                                                                        country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_pref_level_intelligence_educated_robustcheck  <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_level_intelligence_educated ~ political_orientation + age + (1 + political_orientation |
                                                                          country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_pref_level_kind_supportive_robustcheck <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_level_kind_supportive ~ political_orientation + age + (1 + political_orientation |
                                                                    country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_pref_level_attractiveness_robustcheck <-
  as.data.frame(standardize_parameters(
    lmer(
      pref_level_attractiveness ~ political_orientation + age + (1 + political_orientation |
                                                                   country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))
```

#### Combine {.active}
```{r}
all_models_ipp <- rbind(
  model_pref_level_financially_secure_successful_ambitious,
  model_pref_level_confident_assertive,
  model_pref_level_intelligence_educated,
  model_pref_level_kind_supportive,
  model_pref_level_attractiveness,
  model_pref_level_financially_secure_successful_ambitious_robustcheck,
  model_pref_level_confident_assertive_robustcheck,
  model_pref_level_intelligence_educated_robustcheck,
  model_pref_level_kind_supportive_robustcheck,
  model_pref_level_attractiveness_robustcheck
) %>%
  filter(Parameter == "political_orientation")

all_models_ipp$hypothesis = factor(
  rep(
    c(
      "H2a) Financial Security-\nSuccessfulness",
      "H2b) Confidence-\nAssertiveness",
      "H2c) Education-\nIntelligence",
      "H2d) Kindness-\nSupportiveness",
      "H2e) Attractiveness"
    ),
    2
  ),
  levels = c(
    "H2e) Attractiveness",
    "H2d) Kindness-\nSupportiveness",
    "H2c) Education-\nIntelligence",
    "H2b) Confidence-\nAssertiveness",
    "H2a) Financial Security-\nSuccessfulness"
  )
)

all_models_ipp$type = factor(c(rep("Main Analyses", 5), rep("Robustness Analyses", 5)),
                             levels = c("Robustness Analyses", "Main Analyses"))


multiplot = ggplot(all_models_ipp, aes(hypothesis, Std_Coefficient)) +
  geom_pointrange(
    data = all_models_ipp,
    mapping = aes(
      x = hypothesis,
      y = Std_Coefficient,
      ymin = CI_low,
      ymax = CI_high,
      group = type,
      color = type
    ),
    position = position_dodge(width = 0.3)
  ) +
  geom_hline(yintercept = 0, linewidth = 1.5)  +
  geom_hline(yintercept = -.05,
             linetype = "dotted",
             linewidth = 1.5) +
  geom_hline(yintercept = .05,
             linetype = "dotted",
             linewidth = 1.5) +
  coord_flip() +
  apatheme +
  scale_colour_manual(values = c("#86BDDB", "#084594"))  +
  labs(y = "Linear Effect of Political Orientation", x = "Outcome") +
  theme(
    text = element_text(size = 15),
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    legend.text = element_text(size = 10),
    plot.title = element_text(hjust = 0),
    legend.background = element_rect(
      fill = "grey",
      linewidth = 0.5,
      linetype = "solid"
    )
  ) + guides(col = guide_legend(reverse = TRUE))
multiplot
```

#### Save image
```{r}
jpeg("Figure7.1.jpeg",
     width = 3150,
     height = 2100,
     res = 300)
multiplot
dev.off()
```

### Figure 8 {.tabset}
Effect size estimates of linear effects of political orientation on ideal partner's age and height for main analyses and one robustness analysis.

#### Main Analyses
```{r}
model_imp_age <-
  as.data.frame(standardize_parameters(
    lmer(
      imp_age ~ political_orientation + (1 + political_orientation |
                                           country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_ideal_age_rel <-
  as.data.frame(standardize_parameters(
    lmer(
      ideal_age_rel ~ political_orientation + (1 + political_orientation |
                                                 country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_imp_height <-
  as.data.frame(standardize_parameters(
    lmer(
      imp_height ~ political_orientation + (1 + political_orientation |
                                              country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_ideal_height <-
  as.data.frame(standardize_parameters(
    lmer(
      ideal_height ~ political_orientation + (1 + political_orientation |
                                                country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))
```

#### Robustness Analyses
Additionally including age as a predictor
```{r}
model_imp_age_robustcheck <-
  as.data.frame(standardize_parameters(
    lmer(
      imp_age ~ political_orientation + age + (1 + political_orientation |
                                                 country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_ideal_age_rel_robustcheck <-
  as.data.frame(standardize_parameters(
    lmer(
      ideal_age_rel ~ political_orientation + age + (1 + political_orientation |
                                                       country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_imp_height_robustcheck <-
  as.data.frame(standardize_parameters(
    lmer(
      imp_height ~ political_orientation + age + (1 + political_orientation |
                                                    country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))

model_ideal_height_robustcheck  <-
  as.data.frame(standardize_parameters(
    lmer(
      ideal_height ~ political_orientation + age + (1 + political_orientation |
                                                      country),
      data = data_included_documented,
      control = lmerControl(optimizer = "bobyqa")
    ),
    method = "basic",
    ci = 0.997
  ))
```

#### Combine {.active}
```{r}
all_models_ageheight <- rbind(
  model_imp_age,
  model_ideal_age_rel,
  model_imp_height,
  model_ideal_height,
  model_imp_age_robustcheck,
  model_ideal_age_rel_robustcheck,
  model_imp_height_robustcheck,
  model_ideal_height_robustcheck
) %>%
  filter(Parameter == "political_orientation")

all_models_ageheight$hypothesis = factor(
  rep(
    c(
      "H3a(1)) Ideal Age \n(Importance)",
      "H3a(2)) Ideal Age \n(Level)",
      "H3b(1)) Ideal Height \n(Importance)",
      "H3b(2)) Ideal Height \n(Level)"
    ),
    2
  ),
  levels = c(
    "H3b(2)) Ideal Height \n(Level)",
    "H3b(1)) Ideal Height \n(Importance)",
    "H3a(2)) Ideal Age \n(Level)",
    "H3a(1)) Ideal Age \n(Importance)"
  )
)

all_models_ageheight$type = factor(c(rep("Main Analyses", 4), rep("Robustness Analyses", 4)),
                                   levels = c("Robustness Analyses", "Main Analyses"))


multiplot = ggplot(all_models_ageheight, aes(hypothesis, Std_Coefficient)) +
  geom_pointrange(
    data = all_models_ageheight,
    mapping = aes(
      x = hypothesis,
      y = Std_Coefficient,
      ymin = CI_low,
      ymax = CI_high,
      group = type,
      color = type
    ),
    position = position_dodge(width = 0.3)
  ) +
  geom_hline(yintercept = 0, linewidth = 1.5)  +
  geom_hline(yintercept = -.05,
             linetype = "dotted",
             linewidth = 1.5) +
  geom_hline(yintercept = .05,
             linetype = "dotted",
             linewidth = 1.5) +
  coord_flip() +
  apatheme +
  scale_colour_manual(values = c("#86BDDB", "#084594"))  +
  labs(y = "Linear Effect of Political Orientation", x = "Outcome") +
  theme(
    text = element_text(size = 15),
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    legend.text = element_text(size = 10),
    plot.title = element_text(hjust = 0),
    legend.background = element_rect(
      fill = "grey",
      linewidth = 0.5,
      linetype = "solid"
    )
  ) + guides(col = guide_legend(reverse = TRUE))
multiplot
```

#### Save image
```{r}
jpeg("Figure8.1.jpeg",
     width = 3150,
     height = 2100,
     res = 300)
multiplot
dev.off()
```
