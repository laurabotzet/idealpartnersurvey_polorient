---
title: "08_graphs_exploratory"
author: "Lena Kuschel"
date: "30 November 2020"
output: 
  html_document:
    code_folding: "hide"
editor_options: 
  chunk_output_type: console
---


## Graphs {.tabset}

### Library
```{r Library}
library(formr)
library(effects)
library(effectsize)
library(lme4)
library(sjstats)
library(lmerTest)
library(ggplot2)
library(tidyr)
library(ggpubr)
library(RColorBrewer)
library(coefplot)
library(tibble)
library(purrr) # for running multiple regression
library(broom)
library(lm.beta)
library(dplyr)
library(stringr)
library(tidyr)

apatheme = theme_bw() +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        axis.line = element_line(),
        legend.title = element_blank(),
        plot.title = element_text(hjust = 0.5))
```


### Data
Load selected data based on 03_codebook
```{r}
data_included_documented = read.csv(file = "data_included_documented.csv")[,-1]
```


### Inclusion of data
```{r}
countries = as.data.frame(table(data_included_documented$country)) %>%
  arrange(-Freq)

countries
```
We will include all countries with more than 500 participants. This allows us to show effect sizes for a diverse range of countries.
Diversity of countries is indicated by:

* location: European (France, Germany, Italy, Spain); North American (United States of America); South American (Mexico, Brazil)
* language: French (France); German (Germany); English (United States of America); Spanish (Mexico, Spain); Italian (Italy); Portuguese (Brazil)
* culture: Western (France, Germany, Italy, Spain, United States of America); Non-Western (Mexico, Brazil)

Sample sizes of other countries are too small (n < 500) to reach any conclusions.

```{r}
seven_countries = countries %>% filter(Freq > 500)
data_included_documented_rescon = data_included_documented %>%
  filter(country %in% seven_countries$Var1)
```

```{r}
countries_rescon = as.data.frame(table(data_included_documented_rescon$country)) %>%
  arrange(-Freq)
countries_rescon
```

### Models
#### H1a Interest in Single Life
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(interest_single, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_interest_single = data_included_documented_rescon_wide %>%
  select(-interest_single) %>%
  map(~lm(data_included_documented_rescon_wide$interest_single ~ .x,
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_interest_single_coef = models_interest_single %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_interest_single_confint_low = models_interest_single %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_interest_single_confint_high = models_interest_single %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_interest_single_graph = left_join(left_join(models_interest_single_coef,
                                         models_interest_single_confint_low,
                                         by = "name"),
                                         models_interest_single_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H1a) Interest in Single Life")
```

####  H1b Interest in sexual, non-romantic relationships
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(interest_sexrel, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_interest_sexrel = data_included_documented_rescon_wide %>%
  select(-interest_sexrel) %>%
  map(~lm(data_included_documented_rescon_wide$interest_sexrel ~ .x,
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_interest_sexrel_coef = models_interest_sexrel %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_interest_sexrel_confint_low = models_interest_sexrel %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_interest_sexrel_confint_high = models_interest_sexrel %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_interest_sexrel_graph = left_join(left_join(models_interest_sexrel_coef,
                                         models_interest_sexrel_confint_low,
                                         by = "name"),
                                         models_interest_sexrel_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H1b) Interest in Sexual,\nNon-Romantic Relationships")
```

#### H1c Interest in non-monogamous relationships
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(interest_nonmonrel, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_interest_nonmonrel = data_included_documented_rescon_wide %>%
  select(-interest_nonmonrel) %>%
  map(~lm(data_included_documented_rescon_wide$interest_nonmonrel ~ .x,
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_interest_nonmonrel_coef = models_interest_nonmonrel %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_interest_nonmonrel_confint_low = models_interest_nonmonrel %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_interest_nonmonrel_confint_high = models_interest_nonmonrel %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_interest_nonmonrel_graph = left_join(left_join(models_interest_nonmonrel_coef,
                                         models_interest_nonmonrel_confint_low,
                                         by = "name"),
                                         models_interest_nonmonrel_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H1c) Interest in \nNon-Monogamous Relationships")
```

#### H1d Interest in monogamous relationships
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(interest_monrel, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_interest_monrel = data_included_documented_rescon_wide %>%
  select(-interest_monrel) %>%
  map(~lm(data_included_documented_rescon_wide$interest_monrel ~ .x,
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_interest_monrel_coef = models_interest_monrel %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_interest_monrel_confint_low = models_interest_monrel %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_interest_monrel_confint_high = models_interest_monrel %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_interest_monrel_graph = left_join(left_join(models_interest_monrel_coef,
                                         models_interest_monrel_confint_low,
                                         by = "name"),
                                         models_interest_monrel_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H1d) Interest in \nMonogamous Relationships")
```

#### H2a Preference for similarity in political beliefs
##### Linear Effect
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(pref_politicalsim, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_pref_politicalsim = data_included_documented_rescon_wide %>%
  select(-pref_politicalsim) %>%
  map(~lm(scale(data_included_documented_rescon_wide$pref_politicalsim) ~ scale(.x) +
            I(scale(.x)^2),
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_pref_politicalsim_lin_coef = models_pref_politicalsim %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname == "scale(.x)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_pref_politicalsim_lin_confint_low = models_pref_politicalsim %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname  == "scale(.x)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_pref_politicalsim_lin_confint_high = models_pref_politicalsim %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname  == "scale(.x)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_pref_politicalsim_lin_graph = left_join(left_join(models_pref_politicalsim_lin_coef,
                                         models_pref_politicalsim_lin_confint_low,
                                         by = "name"),
                                         models_pref_politicalsim_lin_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H2a) Preferred Political \nSimilarity - Linear Effect")
```

##### Quadratic Effect
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(pref_politicalsim, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_pref_politicalsim = data_included_documented_rescon_wide %>%
  select(-pref_politicalsim) %>%
  map(~lm(scale(data_included_documented_rescon_wide$pref_politicalsim) ~ scale(.x) +
            I(scale(.x)^2),
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_pref_politicalsim_quad_coef = models_pref_politicalsim %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname == "I(scale(.x)^2)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_pref_politicalsim_quad_confint_low = models_pref_politicalsim %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname  == "I(scale(.x)^2)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_pref_politicalsim_quad_confint_high = models_pref_politicalsim %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname  == "I(scale(.x)^2)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_pref_politicalsim_quad_graph = left_join(left_join(models_pref_politicalsim_quad_coef,
                                         models_pref_politicalsim_quad_confint_low,
                                         by = "name"),
                                         models_pref_politicalsim_quad_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H2a) Preferred Political \nSimilarity - Quadratic Effect")
```

#### H2b Preference for similarity in ethnicity/race
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(pref_ethnicalsim, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_pref_ethnicalsim = data_included_documented_rescon_wide %>%
  select(-pref_ethnicalsim) %>%
  map(~lm(scale(data_included_documented_rescon_wide$pref_ethnicalsim) ~ scale(.x) +
            I(scale(.x)^2),
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_pref_ethnicalsim_coef = models_pref_ethnicalsim %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname == "scale(.x)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_pref_ethnicalsim_confint_low = models_pref_ethnicalsim %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname  == "scale(.x)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_pref_ethnicalsim_confint_high = models_pref_ethnicalsim %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname  == "scale(.x)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_pref_ethnicalsim_graph = left_join(left_join(models_pref_ethnicalsim_coef,
                                         models_pref_ethnicalsim_confint_low,
                                         by = "name"),
                                         models_pref_ethnicalsim_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H2b) Preferred \nEthnic Similarity")
```

#### H2c Preference for similarity in religion
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(pref_religioussim, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_pref_religioussim = data_included_documented_rescon_wide %>%
  select(-pref_religioussim) %>%
  map(~lm(scale(data_included_documented_rescon_wide$pref_religioussim) ~ scale(.x) +
            I(scale(.x)^2),
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_pref_religioussim_coef = models_pref_religioussim %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname == "scale(.x)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_pref_religioussim_confint_low = models_pref_religioussim %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname  == "scale(.x)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_pref_religioussim_confint_high = models_pref_religioussim %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname  == "scale(.x)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_pref_religioussim_graph = left_join(left_join(models_pref_religioussim_coef,
                                         models_pref_religioussim_confint_low,
                                         by = "name"),
                                         models_pref_religioussim_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H2c) Preferred \nReligious Similarity")
```

#### H3a Preference for the level of financial security- successfulness 
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(pref_level_financially_secure_successful_ambitious, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_pref_level_financially_secure_successful_ambitious = data_included_documented_rescon_wide %>%
  select(-pref_level_financially_secure_successful_ambitious) %>%
  map(~lm(data_included_documented_rescon_wide$pref_level_financially_secure_successful_ambitious ~ .x,
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_pref_level_financially_secure_successful_ambitious_coef = models_pref_level_financially_secure_successful_ambitious %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_pref_level_financially_secure_successful_ambitious_confint_low = models_pref_level_financially_secure_successful_ambitious %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_pref_level_financially_secure_successful_ambitious_confint_high = models_pref_level_financially_secure_successful_ambitious %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_pref_level_financially_secure_successful_ambitious_graph = left_join(left_join(models_pref_level_financially_secure_successful_ambitious_coef,
                                         models_pref_level_financially_secure_successful_ambitious_confint_low,
                                         by = "name"),
                                         models_pref_level_financially_secure_successful_ambitious_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H3a) Financial Security-\nSuccessfulness")
```

#### H3b Preference for the level of kindness-supportiveness
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(pref_level_kind_supportive, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_pref_level_kind_supportive = data_included_documented_rescon_wide %>%
  select(-pref_level_kind_supportive) %>%
  map(~lm(data_included_documented_rescon_wide$pref_level_kind_supportive ~ .x,
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_pref_level_kind_supportive_coef = models_pref_level_kind_supportive %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_pref_level_kind_supportive_confint_low = models_pref_level_kind_supportive %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_pref_level_kind_supportive_confint_high = models_pref_level_kind_supportive %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_pref_level_kind_supportive_graph = left_join(left_join(models_pref_level_kind_supportive_coef,
                                         models_pref_level_kind_supportive_confint_low,
                                         by = "name"),
                                         models_pref_level_kind_supportive_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H3b) Kindness-\nSupportiveness")
```

#### H3c Preference for the level of attractiveness
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(pref_level_attractiveness, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_pref_level_attractiveness = data_included_documented_rescon_wide %>%
  select(-pref_level_attractiveness) %>%
  map(~lm(data_included_documented_rescon_wide$pref_level_attractiveness ~ .x,
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_pref_level_attractiveness_coef = models_pref_level_attractiveness %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_pref_level_attractiveness_confint_low = models_pref_level_attractiveness %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_pref_level_attractiveness_confint_high = models_pref_level_attractiveness %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_pref_level_attractiveness_graph = left_join(left_join(models_pref_level_attractiveness_coef,
                                         models_pref_level_attractiveness_confint_low,
                                         by = "name"),
                                         models_pref_level_attractiveness_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H3c) Attractiveness")
```

#### H3d Preference for the level of confidence-assertiveness
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(pref_level_confident_assertive, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_pref_level_confident_assertive = data_included_documented_rescon_wide %>%
  select(-pref_level_confident_assertive) %>%
  map(~lm(data_included_documented_rescon_wide$pref_level_confident_assertive ~ .x,
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_pref_level_confident_assertive_coef = models_pref_level_confident_assertive %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_pref_level_confident_assertive_confint_low = models_pref_level_confident_assertive %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_pref_level_confident_assertive_confint_high = models_pref_level_confident_assertive %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_pref_level_confident_assertive_graph = left_join(left_join(models_pref_level_confident_assertive_coef,
                                         models_pref_level_confident_assertive_confint_low,
                                         by = "name"),
                                         models_pref_level_confident_assertive_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H3d) Confidence-\nAssertiveness")
```

#### H3e Preference for the level of education-intelligence
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(pref_level_intelligence_educated, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_pref_level_intelligence_educated = data_included_documented_rescon_wide %>%
  select(-pref_level_intelligence_educated) %>%
  map(~lm(data_included_documented_rescon_wide$pref_level_intelligence_educated ~ .x,
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_pref_level_intelligence_educated_coef = models_pref_level_intelligence_educated %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_pref_level_intelligence_educated_confint_low = models_pref_level_intelligence_educated %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_pref_level_intelligence_educated_confint_high = models_pref_level_intelligence_educated %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_pref_level_intelligence_educated_graph = left_join(left_join(models_pref_level_intelligence_educated_coef,
                                         models_pref_level_intelligence_educated_confint_low,
                                         by = "name"),
                                         models_pref_level_intelligence_educated_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H3e) Education-\nIntelligence")
```

#### H4a(1) Ideal age (importance)
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(imp_age, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_imp_age = data_included_documented_rescon_wide %>%
  select(-imp_age) %>%
  map(~lm(data_included_documented_rescon_wide$imp_age ~ .x,
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_imp_age_coef = models_imp_age %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_imp_age_confint_low = models_imp_age %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_imp_age_confint_high = models_imp_age %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_imp_age_graph = left_join(left_join(models_imp_age_coef,
                                         models_imp_age_confint_low,
                                         by = "name"),
                                         models_imp_age_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H4a(1)) Ideal Age \n(Importance)")
```

#### H4a(2) Ideal age (level)
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(ideal_age_rel, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_ideal_age_rel = data_included_documented_rescon_wide %>%
  select(-ideal_age_rel) %>%
  map(~lm(data_included_documented_rescon_wide$ideal_age_rel ~ .x,
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_ideal_age_rel_coef = models_ideal_age_rel %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_ideal_age_rel_confint_low = models_ideal_age_rel %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_ideal_age_rel_confint_high = models_ideal_age_rel %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_ideal_age_rel_graph = left_join(left_join(models_ideal_age_rel_coef,
                                         models_ideal_age_rel_confint_low,
                                         by = "name"),
                                         models_ideal_age_rel_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H4a(2)) Ideal Age \n(Level)")
```

#### H4b(1) Ideal height (importance)
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(imp_height, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_imp_height = data_included_documented_rescon_wide %>%
  select(-imp_height) %>%
  map(~lm(data_included_documented_rescon_wide$imp_height ~ .x,
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_imp_height_coef = models_imp_height %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_imp_height_confint_low = models_imp_height %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_imp_height_confint_high = models_imp_height %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_imp_height_graph = left_join(left_join(models_imp_height_coef,
                                         models_imp_height_confint_low,
                                         by = "name"),
                                         models_imp_height_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H4b(1)) Ideal Height \n(Importance)")
```

#### H4b(2) Ideal height (level)
```{r}
data_included_documented_rescon_wide = data_included_documented_rescon %>%
  pivot_wider(names_from = country, values_from = political_orientation) %>%
  select(ideal_height, France, Germany, `United States of America`, Mexico,
         Italy, Brazil, Spain)

models_ideal_height = data_included_documented_rescon_wide %>%
  select(-ideal_height) %>%
  map(~lm(data_included_documented_rescon_wide$ideal_height ~ .x,
      data = data_included_documented_rescon_wide)) %>%
  map(lm.beta)

models_ideal_height_coef = models_ideal_height %>%
  map(coef) %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  rename(mean = value)

models_ideal_height_confint_low = models_ideal_height %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "0.15")) %>%
  rename(conf_low = value) %>%
  mutate(name = substr(name, 1, nchar(name)-7))

models_ideal_height_confint_high = models_ideal_height %>%
  map(confint, level = 0.997)  %>%
  as.data.frame() %>%
  rownames_to_column(var = "rowname") %>%
  filter(rowname != "(Intercept)") %>%
  pivot_longer(cols = -rowname) %>%
  select(-rowname) %>%
  filter(str_detect(name, "99.85")) %>%
  rename(conf_high = value) %>%
  mutate(name = substr(name, 1, nchar(name)-8))

models_ideal_height_graph = left_join(left_join(models_ideal_height_coef,
                                         models_ideal_height_confint_low,
                                         by = "name"),
                                         models_ideal_height_confint_high,
                                         by = "name") %>%
  mutate(outcome = "H4b(2)) Ideal Height \n(Level)")
```

### Combine Graph One
```{r}
data_graph = rbind(models_interest_single_graph, models_interest_sexrel_graph,
                   models_interest_nonmonrel_graph, models_interest_monrel_graph,
                   models_pref_politicalsim_lin_graph, models_pref_politicalsim_quad_graph, models_pref_ethnicalsim_graph, models_pref_religioussim_graph) %>%
  mutate(outcome = factor(outcome,
                          levels = c("H2c) Preferred \nReligious Similarity", 
                                     "H2b) Preferred \nEthnic Similarity",
                                     "H2a) Preferred Political \nSimilarity - Quadratic Effect",
                                     "H2a) Preferred Political \nSimilarity - Linear Effect",
                                     "H1d) Interest in \nMonogamous Relationships",
                                     "H1c) Interest in \nNon-Monogamous Relationships",
                                     "H1b) Interest in Sexual,\nNon-Romantic Relationships",
                                   "H1a) Interest in Single Life")))


data_graph$name = factor(rep(c(
  paste0("France (n = ",
         sum(data_included_documented_rescon$country == "France"), ")"),
  paste0("Germany (n = ",
         sum(data_included_documented_rescon$country == "Germany"), ")"),
  paste0("United States of America (n = ",
         sum(data_included_documented_rescon$country == "United States of America"),
         ")"),
  paste0("Mexico (n = ",
         sum(data_included_documented_rescon$country == "Mexico"), ")"),
  paste0("Italy (n = ",
         sum(data_included_documented_rescon$country == "Italy"), ")"),
  paste0("Brazil (n = ",
         sum(data_included_documented_rescon$country == "Brazil"), ")"),
  paste0("Spain (n = ",
         sum(data_included_documented_rescon$country == "Spain"), ")")),
  8))

l_countries = levels(data_graph$name)
data_graph$name = factor(data_graph$name,
                         levels = rev(c(l_countries[2], l_countries[3],
                                    l_countries[7], l_countries[5],
                                    l_countries[4], l_countries[1],
                                    l_countries[6])))
```

### Graph One Multiplot
```{r}
multiplot = ggplot(data_graph, aes(outcome, mean)) +
  geom_hline(yintercept = 0, size = 1.5)  +
  geom_hline(yintercept = -.05, linetype = "dotted", size = 1.5) + 
  geom_hline(yintercept = .05, linetype = "dotted", size = 1.5) +
  geom_pointrange(data = data_graph,
                  mapping = aes(x = outcome, y = mean,
                                ymin = conf_low , ymax = conf_high , group = name,
                                color = name),
                  position = position_dodge(width=0.4)) + 
  coord_flip() +
  apatheme +
  scale_colour_brewer(palette = "Dark2")  +
  labs(y = "Effect of Right-Wing Political Orientation", x = "Outcome") +
  theme(text = element_text(size=20), axis.text.x = element_text(size = 15),
        axis.text.y = element_text(size = 15),
        legend.text = element_text(size = 15),
        plot.title = element_text(hjust = 0),
        legend.background = element_rect(fill="grey", 
                                         size=0.5, linetype="solid")) +
  guides(col = guide_legend(reverse= TRUE))
multiplot
```

#### Save image
```{r}
jpeg("Exploratory_01.jpeg", width = 1200, height = 1600, pointsize = 100, quality = 100)
multiplot
dev.off()
```

### Combine Graph Two
```{r}
data_graph2 = rbind(models_pref_level_financially_secure_successful_ambitious_graph, models_pref_level_kind_supportive_graph, models_pref_level_attractiveness_graph, models_pref_level_confident_assertive_graph, models_pref_level_intelligence_educated_graph, models_imp_age_graph, models_ideal_age_rel_graph, models_imp_height_graph, models_ideal_height_graph) %>%
  mutate(outcome = factor(outcome,
                          levels = c("H4b(2)) Ideal Height \n(Level)","H4b(1)) Ideal Height \n(Importance)","H4a(2)) Ideal Age \n(Level)","H4a(1)) Ideal Age \n(Importance)","H3e) Education-\nIntelligence","H3d) Confidence-\nAssertiveness","H3c) Attractiveness", "H3b) Kindness-\nSupportiveness", "H3a) Financial Security-\nSuccessfulness")))


data_graph2$name = factor(rep(c(
  paste0("France (n = ",
         sum(data_included_documented_rescon$country == "France"), ")"),
  paste0("Germany (n = ",
         sum(data_included_documented_rescon$country == "Germany"), ")"),
  paste0("United States of America (n = ",
         sum(data_included_documented_rescon$country == "United States of America"),
         ")"),
  paste0("Mexico (n = ",
         sum(data_included_documented_rescon$country == "Mexico"), ")"),
  paste0("Italy (n = ",
         sum(data_included_documented_rescon$country == "Italy"), ")"),
  paste0("Brazil (n = ",
         sum(data_included_documented_rescon$country == "Brazil"), ")"),
  paste0("Spain (n = ",
         sum(data_included_documented_rescon$country == "Spain"), ")")),
  9))

l_countries2 = levels(data_graph2$name)
data_graph2$name = factor(data_graph2$name,
                         levels = rev(c(l_countries[2], l_countries[3],
                                    l_countries[7], l_countries[5],
                                    l_countries[4], l_countries[1],
                                    l_countries[6])))
```

### Graph Two Multiplot
```{r}
multiplot2 = ggplot(data_graph2, aes(outcome, mean)) +
  geom_hline(yintercept = 0, size = 1.5)  +
  geom_hline(yintercept = -.05, linetype = "dotted", size = 1.5) + 
  geom_hline(yintercept = .05, linetype = "dotted", size = 1.5) +
  geom_pointrange(data = data_graph2,
                  mapping = aes(x = outcome, y = mean,
                                ymin = conf_low , ymax = conf_high , group = name,
                                color = name),
                  position = position_dodge(width=0.4)) + 
  coord_flip() +
  apatheme +
  scale_colour_brewer(palette = "Dark2")  +
  labs(y = "Effect of Right-Wing Political Orientation", x = "Outcome") +
  theme(text = element_text(size=20), axis.text.x = element_text(size = 15),
        axis.text.y = element_text(size = 15),
        legend.text = element_text(size = 15),
        plot.title = element_text(hjust = 0),
        legend.background = element_rect(fill="grey", 
                                         size=0.5, linetype="solid")) +
  guides(col = guide_legend(reverse= TRUE))
multiplot2
```

#### Save image
```{r}
jpeg("Exploratory_02.jpeg", width = 1200, height = 1500, pointsize = 100, quality = 100)
multiplot2
dev.off()
```
